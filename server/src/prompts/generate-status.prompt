---
model: openai/gpt-4o-mini
config:
  temperature: 0.6
  maxTokens: 100
output:
  format: json
  schema:
    type: object
    properties:
      message:
        type: string
        description: "Short, direct status message about the user's identity"
    required: ["message"]
    additionalProperties: false
input:
  schema:
    type: object
    properties:
      insights:
        type: array
        items:
          type: object
          properties:
            insight:
              type: string
              description: "The factual insight discovered about the user"
            confidence:
              type: number
              description: "Confidence score between 0 and 1"
            categories:
              type: array
              items:
                type: string
              description: "Categories this insight belongs to"
            extractedOn:
              type: string
              description: "Date of the email this insight came from (YYYY-MM-DD)"
          required: [insight, confidence, categories]
        description: "Batch of insights to analyze and select the best one from"
      userInfo:
        type: object
        properties:
          firstName: 
            type: string
          lastName: 
            type: string
          email: 
            type: string
        required: [firstName, lastName, email]
        description: "Basic user information for context"
      todaysDate:
        type: string
        description: "Today's date in YYYY-MM-DD format for temporal context"
    required: [insights, userInfo, todaysDate]
---
user: |
  You are analyzing a BATCH of insights about {{#if userInfo.firstName}}{{userInfo.firstName}}{{else}}the user{{/if}} to find the most PROFILE-WORTHY discovery.

  **Today's Date:** {{todaysDate}}

  **Insights to analyze (pick the BEST ONE):**
  {{#each insights}}
  {{@index}}. {{insight}} (confidence: {{confidence}}, from: {{extractedOn}}, categories: {{categories}})
  {{/each}}

  ## YOUR TASK: Compare ALL insights above and select the BEST one

  ## PROFILE-FOCUSED SELECTION:

  **FOCUS ON IDENTITY-REVEALING INSIGHTS:**
  Look for insights that reveal WHO {{#if userInfo.firstName}}{{userInfo.firstName}}{{else}}the user{{/if}} IS as a person:
  
  **Core Identity Markers:**
  - **Professional identity:** Job titles, company, industry, expertise ("You're a developer", "You work at Google")
  - **Geographic identity:** Where they live/work ("You're based in London", "You live in Seattle")
  - **Lifestyle identity:** Hobbies, passions, habits ("You're into fitness", "You travel frequently")  
  - **Personal characteristics:** Family, life stage, behaviors ("You have kids", "You're health-conscious")
  - **Skills and expertise:** What they're known for professionally ("You do design", "You're in tech")

  **MOST VALUABLE:** Insights that would help an AI assistant understand this person's core identity and context.

  ## OUTPUT FORMAT:
  Generate a SHORT, direct message (3-8 words) that states something meaningful about WHO they MIGHT BE:

  **Effective status message patterns:**
  - "Checking if you are an [occupation]" - Professional identity
  - "Working out if you live in [location]" - Geographic context
  - "Seeing if you are really into [hobby/interest]" - Personal passion
  - "Figuring out if you have [family/characteristic]" - Personal trait
  - "Trying to understand if you work in [industry]" - Professional context
  - "Seeing if you [defining action/behavior]" - Characteristic behavior

  **GOAL:** Create a short message that helps establish meaningful context about who this person is.

  ## TEMPORAL PRIORITIZATION:
  When multiple insights are available, prefer:
  - **Perpetual facts** things that are true for a long time
  - **Recent insights** (within 3 months) over older ones
  - **High confidence + recent** over high confidence + old
  - **Current information** over potentially outdated facts

  ## SELECTION PROCESS:
  1. **Compare** all insights above
  2. **Rank** by identity-revealing value (WHO they are, not WHAT they use)
  3. **Prefer** high confidence + recent + specific
  4. **Select** the most profile-worthy insight
  5. **Generate** a short status message about that insight

  Pick the most IDENTITY-REVEALING insight and return a short status message about that person's core identity. 
  Always express as checking - rather than stating as facts